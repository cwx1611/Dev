# -*- coding: utf-8 -*-
# @Author: jrcaiwenxi
# @Date:   2017-05-11 18:50:56
# @Last Modified by:   jrcaiwenxi
# @Last Modified time: 2017-05-12 10:30:51
from WindPy import w

w.start();
# 命令如何写可以用命令生成器来辅助完成
# 定义打印输出函数，用来展示数据使用
def printpy(outdata):
    if outdata.ErrorCode!=0:
        print('error code:'+str(outdata.ErrorCode)+'\n');
        return();
    for i in range(0,len(outdata.Data[0])):
        strTemp=''
        if len(outdata.Times)>1:
            strTemp=str(outdata.Times[i])+' '
        for k in range(0, len(outdata.Fields)):
            strTemp=strTemp+str(outdata.Data[k][i])+' '
        print(strTemp)

# 通过wsd来提取时间序列数据，比如取开高低收成交量，成交额数据（总股数、总金额）
print('\n\n'+'-----通过wsd来提取时间序列数据，比如取开高低收成交量，成交额数据-----'+'\n')
wsddata1=w.wsd("002555.SZ", "open,high,low,close,volume,amt", "2017-05-10", "2017-05-10", "Fill=Previous")
printpy(wsddata1)

# 通过wst来取日内成交数据 (最近成交价，最近成交总股数)
print('\n\n'+'-----通过wst来取日内成交数据-----'+'\n')
wstdata=w.wst("002555.SZ", "last,volume", "2017-05-11 10:00:22", "2017-05-11 10:01:18")
printpy(wstdata)

# 通过wsi来取日内分钟数据
print('\n\n'+'-----通过wsi来取日内分钟数据-----'+'\n')
wsidata=w.wsi("002555.SZ", "open,high,low,close,volume,amt", "2017-05-11 10:00:22", "2017-05-11 10:01:18")
printpy(wsidata)

# 通过wset来取数据集数据
print('\n\n'+'-----通过wset来取数据集数据,获取沪深300指数权重-----'+'\n')
wsetdata=w.wset("IndexConstituent","date=20170511;windcode=399005.SZ;field=date,wind_code,i_weight")
printpy(wsetdata)








Welcome to use Wind Quant API for Python (WindPy)!
You can use w.menu to help yourself to create commands(WSD,WSS,WST,WSI,WSQ,...)!

COPYRIGHT (C) 2016 WIND HONGHUI INFORMATION & TECHKNOLEWDGE CO., LTD. ALL RIGHTS RESERVED.
IN NO CIRCUMSTANCE SHALL WIND BE RESPONSIBLE FOR ANY DAMAGES OR LOSSES CAUSED BY USING WIND QUANT API FOR Python.


-----通过wsd来提取时间序列数据，比如取开高低收成交量，成交额数据-----

23.1 23.88 22.8 22.95 15341685.0 358088322.0 


-----通过wst来取日内成交数据-----

2017-05-11 10:00:24.004997 23.01 2230420.0 
2017-05-11 10:00:27.005001 23.01 2230420.0 
2017-05-11 10:00:30.005005 23.02 2235520.0 
2017-05-11 10:00:33.004999 23.02 2235520.0 
2017-05-11 10:00:36.005003 23.02 2235520.0 
2017-05-11 10:00:39.004997 23.03 2240520.0 
2017-05-11 10:00:42.005000 23.02 2241020.0 
2017-05-11 10:00:45.005004 23.04 2252320.0 
2017-05-11 10:00:48.004998 23.04 2252420.0 
2017-05-11 10:00:51.005002 23.05 2253520.0 
2017-05-11 10:00:57.005000 23.05 2253520.0 
2017-05-11 10:01:00.005003 23.06 2261020.0 
2017-05-11 10:01:03.004997 23.05 2267620.0 
2017-05-11 10:01:06.005001 23.05 2269620.0 
2017-05-11 10:01:09.005005 23.09 2270420.0 
2017-05-11 10:01:12.004999 23.09 2271620.0 
2017-05-11 10:01:15.005002 23.1 2279420.0 


-----通过wsi来取日内分钟数据-----

22.99 23.05 22.99 23.05 42700.0 982921.0 


-----通过wset来取数据集数据,获取沪深300指数权重-----

2017-05-11 00:00:00.005000 002001.SZ 0.6554 
2017-05-11 00:00:00.005000 002004.SZ 0.7124 
2017-05-11 00:00:00.005000 002007.SZ 1.4088 
2017-05-11 00:00:00.005000 002008.SZ 1.7605 
2017-05-11 00:00:00.005000 002010.SZ 0.3403 
2017-05-11 00:00:00.005000 002013.SZ 0.6996 
2017-05-11 00:00:00.005000 002018.SZ 0.5079 
2017-05-11 00:00:00.005000 002022.SZ 0.5408 
2017-05-11 00:00:00.005000 002023.SZ 0.5833 
2017-05-11 00:00:00.005000 002024.SZ 2.6955 
2017-05-11 00:00:00.005000 002027.SZ 0.8099 
2017-05-11 00:00:00.005000 002030.SZ 0.74 
2017-05-11 00:00:00.005000 002038.SZ 0.7477 
2017-05-11 00:00:00.005000 002049.SZ 0.8205 
2017-05-11 00:00:00.005000 002051.SZ 0.8238 
2017-05-11 00:00:00.005000 002065.SZ 1.3917 
2017-05-11 00:00:00.005000 002074.SZ 1.032 
2017-05-11 00:00:00.005000 002075.SZ 1.4458 
2017-05-11 00:00:00.005000 002081.SZ 1.0415 
2017-05-11 00:00:00.005000 002085.SZ 1.1503 
2017-05-11 00:00:00.005000 002092.SZ 0.9355 
2017-05-11 00:00:00.005000 002095.SZ 0.2643 
2017-05-11 00:00:00.005000 002104.SZ 0.4627 
2017-05-11 00:00:00.005000 002108.SZ 0.744 
2017-05-11 00:00:00.005000 002129.SZ 1.0349 
2017-05-11 00:00:00.005000 002142.SZ 2.1629 
2017-05-11 00:00:00.005000 002146.SZ 0.9885 
2017-05-11 00:00:00.005000 002152.SZ 0.6025 
2017-05-11 00:00:00.005000 002153.SZ 0.4977 
2017-05-11 00:00:00.005000 002161.SZ 0.3567 
2017-05-11 00:00:00.005000 002168.SZ 0.937 
2017-05-11 00:00:00.005000 002176.SZ 0.6761 
2017-05-11 00:00:00.005000 002179.SZ 0.7922 
2017-05-11 00:00:00.005000 002183.SZ 0.8959 
2017-05-11 00:00:00.005000 002185.SZ 0.8005 
2017-05-11 00:00:00.005000 002190.SZ 0.3411 
2017-05-11 00:00:00.005000 002191.SZ 0.5914 
2017-05-11 00:00:00.005000 002195.SZ 0.6539 
2017-05-11 00:00:00.005000 002202.SZ 1.7254 
2017-05-11 00:00:00.005000 002223.SZ 0.7472 
2017-05-11 00:00:00.005000 002224.SZ 0.3863 
2017-05-11 00:00:00.005000 002230.SZ 2.1025 
2017-05-11 00:00:00.005000 002236.SZ 1.8936 
2017-05-11 00:00:00.005000 002241.SZ 2.1213 
2017-05-11 00:00:00.005000 002252.SZ 1.2605 
2017-05-11 00:00:00.005000 002261.SZ 0.4677 
2017-05-11 00:00:00.005000 002266.SZ 0.563 
2017-05-11 00:00:00.005000 002273.SZ 0.766 
2017-05-11 00:00:00.005000 002276.SZ 0.4938 
2017-05-11 00:00:00.005000 002280.SZ 0.5374 
2017-05-11 00:00:00.005000 002284.SZ 0.3482 
2017-05-11 00:00:00.005000 002285.SZ 0.4864 
2017-05-11 00:00:00.005000 002292.SZ 0.6094 
2017-05-11 00:00:00.005000 002294.SZ 0.6967 
2017-05-11 00:00:00.005000 002299.SZ 0.5095 
2017-05-11 00:00:00.005000 002304.SZ 3.0658 
2017-05-11 00:00:00.005000 002310.SZ 1.3947 
2017-05-11 00:00:00.005000 002311.SZ 0.8198 
2017-05-11 00:00:00.005000 002340.SZ 1.0702 
2017-05-11 00:00:00.005000 002353.SZ 0.6159 
2017-05-11 00:00:00.005000 002368.SZ 0.5152 
2017-05-11 00:00:00.005000 002375.SZ 0.4887 
2017-05-11 00:00:00.005000 002385.SZ 0.9618 
2017-05-11 00:00:00.005000 002399.SZ 0.5022 
2017-05-11 00:00:00.005000 002400.SZ 0.9467 
2017-05-11 00:00:00.005000 002405.SZ 1.1294 
2017-05-11 00:00:00.005000 002407.SZ 0.8511 
2017-05-11 00:00:00.005000 002410.SZ 0.7048 
2017-05-11 00:00:00.005000 002415.SZ 5.0131 
2017-05-11 00:00:00.005000 002422.SZ 0.7762 
2017-05-11 00:00:00.005000 002424.SZ 0.5082 
2017-05-11 00:00:00.005000 002426.SZ 0.9918 
2017-05-11 00:00:00.005000 002428.SZ 0.3855 
2017-05-11 00:00:00.005000 002437.SZ 0.4027 
2017-05-11 00:00:00.005000 002439.SZ 0.7083 
2017-05-11 00:00:00.005000 002450.SZ 3.3131 
2017-05-11 00:00:00.005000 002456.SZ 2.072 
2017-05-11 00:00:00.005000 002460.SZ 1.4889 
2017-05-11 00:00:00.005000 002465.SZ 1.2405 
2017-05-11 00:00:00.005000 002466.SZ 2.1457 
2017-05-11 00:00:00.005000 002470.SZ 0.7634 
2017-05-11 00:00:00.005000 002475.SZ 1.6962 
2017-05-11 00:00:00.005000 002489.SZ 0.4847 
2017-05-11 00:00:00.005000 002491.SZ 0.6719 
2017-05-11 00:00:00.005000 002500.SZ 0.9226 
2017-05-11 00:00:00.005000 002508.SZ 1.3764 
2017-05-11 00:00:00.005000 002555.SZ 0.5501 
2017-05-11 00:00:00.005000 002570.SZ 0.5087 
2017-05-11 00:00:00.005000 002573.SZ 1.0071 
2017-05-11 00:00:00.005000 002594.SZ 1.9947 
2017-05-11 00:00:00.005000 002610.SZ 0.3663 
2017-05-11 00:00:00.005000 002624.SZ 0.5129 
2017-05-11 00:00:00.005000 002657.SZ 0.4459 
2017-05-11 00:00:00.005000 002673.SZ 1.8831 
2017-05-11 00:00:00.005000 002701.SZ 0.6637 
2017-05-11 00:00:00.005000 002709.SZ 0.4334 
2017-05-11 00:00:00.005000 002716.SZ 0.4195 
2017-05-11 00:00:00.005000 002736.SZ 1.7469 
2017-05-11 00:00:00.005000 002739.SZ 1.6469 
2017-05-11 00:00:00.005000 002797.SZ 0.4331 
[Finished in 1.7s]